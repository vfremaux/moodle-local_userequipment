{"version":3,"sources":["../src/bindcatpng.js"],"names":["define","$","cfg","log","moodlebindcatpng","init","debug","bind","load_change_form","submit_change_form","that","waiter","wwwroot","html","id","attr","replace","mode","ctx","url","get","data","selectpicker","issueid","purpose","val","result","oldclassname","get_status_code","oldvalue","removeClass","newclassname","newvalue","addClass","newlabel","modal","statusix","solve_issue","cmid","sesskey","window","location","quick_find","submit"],"mappings":"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","sourcesContent":["\n/*eslint-disable no-unused-vars */\n\ndefine(['jquery', 'core/config', 'core/log', 'local_userequipment/bootstrap-select'], function($, cfg, log, bootstrapselect) {\n\n    var moodlebindcatpng = {\n\n        init: function() {\n            log.debug('Start AMD Userequipment CatPng initialized');\n            $(\"#id_openmodal\").bind('click', this.load_change_form);\n            $(\"#modal-status-save\").bind('click', this.submit_change_form);\n            log.debug('AMD Userequipment CatPng initialized');\n        },\n\n        load_change_form: function() {\n            var that = $(this);\n\n            var waiter = '<div class=\"centered\"><center><img id=\"detail-waiter\" src=\"';\n            waiter += cfg.wwwroot + '/pix/i/ajaxloader.gif\" /></center></div>';\n            $('#catpng-edit-inner-form').html(waiter);\n\n            var id = that.attr('id').replace(/issue-edit-(.*?)-handle-/, '');\n            var mode = that.attr('data-mode');\n            var ctx = that.attr('data-context');\n\n            var url = cfg.wwwroot + '/local/userequipment/ajax/service.php';\n            url += '?what=getmodalform';\n            url += '&mode=' + mode;\n            url += '&id=' + id;\n            url += '&ctx=' + ctx;\n\n            $.get(url, function(data) {\n                $('#catpng-edit-inner-form').html(data);\n                $(\"#modal-status-save\").attr('data-issue', id);\n                $(\"#modal-status-save\").attr('data-purpose', mode);\n                $('.selectpicker').selectpicker();\n            }, 'html');\n        },\n\n        submit_change_form: function() {\n            var that = $(this);\n\n            var issueid = that.attr('data-issue');\n            var purpose = that.attr('data-purpose');\n            var url = cfg.wwwroot + '/local/userequipment/ajax/service.php';\n            url += '?what=update' + purpose;\n            url += '&id=' + issueid;\n            var selectkey = '#' + purpose + '-select-' + issueid;\n            url += '&' + purpose + '=' + $(selectkey).val();\n\n            $.get(url, function(data) {\n                if (data.result === 'success') {\n                    if (purpose == 'status') {\n                        var oldclassname = 'status-' + moodlebindcatpng.get_status_code(data.oldvalue);\n                        $('.issue-list-status-' + issueid).removeClass(oldclassname);\n                        var newclassname = 'status-' + moodlebindcatpng.get_status_code(data.newvalue);\n                        $('.issue-list-status-' + issueid).addClass(newclassname);\n                    }\n                    $('#tracker-' + purpose + '-' + issueid).html(data.newlabel);\n                    $('#catpng-edit-form').modal('hide'); // Close the modal dialog.\n                }\n            }, 'json');\n        },\n\n        get_status_code: function (statusix) {\n            var statuscodes = ['posted',\n                'open',\n                'resolving',\n                'waiting',\n                'resolved',\n                'abandonned',\n                'transfered',\n                'testing',\n                'validated',\n                'published'\n            ];\n\n            return statuscodes[statusix];\n        },\n\n        solve_issue: function() {\n            var that = $(this);\n\n            var issueid = that.attr('id').replace('resolve-', '');\n            var cmid = that.attr('data-cmid');\n            var url = cfg.wwwroot + '/local/userequipment/view.php?id=' + cmid;\n            url += '&view=view';\n            url += '&screen=mytickets';\n            url += '&what=solve';\n            url += '&issueid=' + issueid;\n            url += '&sesskey=' + cfg.sesskey;\n            window.location = url;\n        },\n\n        quick_find: function() {\n            $('#id-quick-find-form').submit();\n        }\n\n    };\n\n    return moodlebindcatpng;\n});"],"file":"bindcatpng.min.js"}